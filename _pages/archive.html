---
layout: default
permalink: /archive/:year/
---

<script>
// Dynamic archive page - gets year from URL
document.addEventListener('DOMContentLoaded', function() {
    // Get year from URL path
    const pathParts = window.location.pathname.split('/');
    const year = pathParts[pathParts.length - 2] || pathParts[pathParts.length - 1];
    
    if (!year || year === 'archive' || !/^\d{4}$/.test(year)) {
        showAllArchives();
        return;
    }
    
    // Fetch posts data and filter by year
    fetch(getBasePath() + '/search.json')
        .then(response => response.json())
        .then(data => {
            const posts = data.filter(item => item.type === 'post');
            const yearPosts = posts.filter(post => 
                post.date && post.date.includes(year)
            );
            
            displayYearPosts(year, yearPosts);
        })
        .catch(error => {
            console.error('Error loading posts:', error);
            document.getElementById('archive-content').innerHTML = '<p>Error loading posts.</p>';
        });
});

function getBasePath() {
    return window.location.pathname.includes('/mattblogsit-dev') ? '/mattblogsit-dev' : '';
}

function displayYearPosts(year, posts) {
    const content = document.getElementById('archive-content');
    
    if (posts.length === 0) {
        content.innerHTML = `
            <h1>${year} Archive</h1>
            <p>No posts found from ${year}.</p>
            <p><a href="${getBasePath()}/posts/">← Back to All Posts</a></p>
        `;
        return;
    }
    
    let html = `
        <h1>${year} Archive</h1>
        <p>${posts.length} post${posts.length > 1 ? 's' : ''} from ${year}:</p>
        <div class="post-list">
    `;
    
    posts.forEach(post => {
        html += `
            <article class="post-preview">
                <h3><a href="${post.url}">${post.title}</a></h3>
                <div class="post-date">${post.date}</div>
                ${post.excerpt ? `<div class="post-excerpt">${post.excerpt}</div>` : ''}
                <a href="${post.url}" class="read-more">Read more →</a>
            </article>
        `;
    });
    
    html += `
        </div>
        <p><a href="${getBasePath()}/posts/">← Back to All Posts</a></p>
    `;
    
    content.innerHTML = html;
}

function showAllArchives() {
    fetch(getBasePath() + '/search.json')
        .then(response => response.json())
        .then(data => {
            const posts = data.filter(item => item.type === 'post');
            const years = {};
            
            posts.forEach(post => {
                if (post.date) {
                    const year = post.date.split(' ')[2] || post.date.substring(0, 4);
                    if (!years[year]) {
                        years[year] = 0;
                    }
                    years[year]++;
                }
            });
            
            let html = `
                <h1>All Archives</h1>
                <div class="archive-list">
            `;
            
            Object.keys(years).sort().reverse().forEach(year => {
                html += `
                    <div class="archive-item">
                        <h3><a href="${getBasePath()}/archive/${year}/">${year}</a></h3>
                        <p>${years[year]} post${years[year] > 1 ? 's' : ''}</p>
                    </div>
                `;
            });
            
            html += `</div>`;
            document.getElementById('archive-content').innerHTML = html;
        });
}
</script>

<div id="archive-content">
    <p>Loading...</p>
</div>

<style>
.archive-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.archive-item {
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 5px;
    background-color: #f8f9fa;
    text-align: center;
}

.archive-item h3 {
    margin: 0 0 10px 0;
    font-size: 1.5em;
}

.archive-item h3 a {
    color: #3498db;
    text-decoration: none;
}

.archive-item h3 a:hover {
    text-decoration: underline;
}

.archive-item p {
    margin: 0;
    color: #666;
}
</style>