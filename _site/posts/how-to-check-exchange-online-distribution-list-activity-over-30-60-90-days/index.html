<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to check Exchange Online Distribution List activity over 30, 60, 90+ days? - Matt Blogs IT</title>
    <meta name="description" content="A blog about IT, technology, and life by Matt Griffin.">
    
    <link rel="stylesheet" href="/assets/css/style.css">
    <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Matt Blogs IT" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to check Exchange Online Distribution List activity over 30, 60, 90+ days? | Matt Blogs IT</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="How to check Exchange Online Distribution List activity over 30, 60, 90+ days?" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A blog about IT, technology, and life by Matt Griffin." />
<meta property="og:description" content="A blog about IT, technology, and life by Matt Griffin." />
<link rel="canonical" href="http://0.0.0.0:4000/posts/how-to-check-exchange-online-distribution-list-activity-over-30-60-90-days/" />
<meta property="og:url" content="http://0.0.0.0:4000/posts/how-to-check-exchange-online-distribution-list-activity-over-30-60-90-days/" />
<meta property="og:site_name" content="Matt Blogs IT" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-06T00:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to check Exchange Online Distribution List activity over 30, 60, 90+ days?" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-07-06T00:00:00-07:00","datePublished":"2020-07-06T00:00:00-07:00","description":"A blog about IT, technology, and life by Matt Griffin.","headline":"How to check Exchange Online Distribution List activity over 30, 60, 90+ days?","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/posts/how-to-check-exchange-online-distribution-list-activity-over-30-60-90-days/"},"url":"http://0.0.0.0:4000/posts/how-to-check-exchange-online-distribution-list-activity-over-30-60-90-days/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
    <header class="site-header">
        <div class="wrapper">
            <a class="site-title" href="/">Matt Blogs IT</a>
            <nav class="site-nav">
                <a href="/">Home</a>
                <a href="/about-me/">About</a>
                <a href="/archive/">Archive</a>
                <a href="/contact-me/">Contact</a>
                <a href="/my-credentials/">Credentials</a>
            </nav>
        </div>
    </header>

    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            <article class="page">
    <header class="page-header">
        <h1 class="page-title">How to check Exchange Online Distribution List activity over 30, 60, 90+ days?</h1>
    </header>

    <div class="page-content">
        <p>All growing and/or large organizations will experience this. We have all of these Distribution Lists, but does anyone even use them or know why they were created 5, 10, 15 years ago? I recently ran into this at work, where we are trying to figure out if we can safely delete specific Distribution Lists. They have members, but most of the members have no idea they are a member, or why they would even need the email address.</p>

<p>As always, I start my investigation into how to do something with a quick Google Search. I stumbled upon a bunch of articles specific to Exchange on-premises, and a few items on how to see usage in the last 10 days, but nothing more. The next issue with the ones I did find for Exchange Online was only going to handle 1000 email messages, more than that, and you have to add additional parameters to the command and page through the command multiple times for more than 5000.</p>

<p>I knew many of these lists most likely have infrequent usage, if any at all, so 10 days wasn’t going to cut it. My resolution to this problem? Scheduled tasks, and time!</p>

<p>Before you can run this script, you need to make sure you install the <a href="https://www.powershellgallery.com/packages/ExchangeOnlineManagement/2.0.3-Preview">Exchange Online Management PowerShell Module</a>. The module is on the PowerShell Gallery.</p>

<p>The script itself is pretty straightforward. It would be best if you had a secure way to store your passwords that the script will use for authenticating to Office 365. My example script will only work in interactive mode, and you need to dig a bit into storing credentials securely. I would recommend checking out David Lee’s post “<a href="https://purple.telstra.com.au/blog/using-saved-credentials-securely-in-powershell-scripts">Using saved credentials securely in PowerShell scripts</a>” for more information.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Connect-ExchangeOnline</span><span class="w"> </span><span class="nt">-UserPrincipalName</span><span class="w"> </span><span class="nx">user</span><span class="err">@</span><span class="nx">example.com</span><span class="w">

</span><span class="nv">$date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Date</span><span class="w">

</span><span class="nv">$fullResults</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
</span><span class="nv">$i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="kr">do</span><span class="p">{</span><span class="w">
    </span><span class="nv">$trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-MessageTrace</span><span class="w"> </span><span class="nt">-Status</span><span class="w"> </span><span class="nx">expanded</span><span class="w"> </span><span class="nt">-startdate</span><span class="w"> </span><span class="p">(</span><span class="nv">$date</span><span class="p">)</span><span class="o">.</span><span class="nf">AddDays</span><span class="p">(</span><span class="nt">-10</span><span class="p">)</span><span class="w"> </span><span class="nt">-EndDate</span><span class="w"> </span><span class="p">(</span><span class="nv">$date</span><span class="p">)</span><span class="w"> </span><span class="nt">-PageSize</span><span class="w"> </span><span class="mi">5000</span><span class="w"> </span><span class="nt">-Page</span><span class="w"> </span><span class="nv">$i</span><span class="o">|</span><span class="w"> </span><span class="n">Group-Object</span><span class="w"> </span><span class="nx">recipientaddress</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="nx">count</span><span class="w">
    </span><span class="nv">$fullResults</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nv">$trace</span><span class="w">
    </span><span class="nv">$i</span><span class="o">++</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">until</span><span class="p">(</span><span class="bp">$null</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$trace</span><span class="p">)</span><span class="w">

</span><span class="nv">$fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Get-Date</span><span class="w"> </span><span class="nt">-Format</span><span class="w"> </span><span class="s2">"yyyy.MM.dd"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"_DLUsage.csv"</span><span class="w">
</span><span class="nv">$fullResults</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Export-Csv</span><span class="w"> </span><span class="s2">"C:\Reports\</span><span class="nv">$fileName</span><span class="s2">"</span><span class="w"> </span><span class="nt">-NoTypeInformation</span><span class="w">
</span></code></pre></div></div>

<p>All you need to do is update the script to use a securely stored credential and set a scheduled task to run at the same time every 10 days. After however long you want to look at historical data, you import to an Excel spreadsheet and compare!</p>

    </div>
</article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="wrapper">
            <p>&copy; 2025 Matt Blogs IT. All rights reserved.</p>
            <p>
                
                <a href="https://github.com/mattgriffin">GitHub</a> |
                
                
                <a href="https://twitter.com/mattgriffinit">Twitter</a>
                
            </p>
        </div>
    </footer>
</body>
</html>