<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configure Surface to use MicroSD as Primary Storage - Matt Blogs IT</title>
    <meta name="description" content="After about a week of excitement and playing around with features, I decided it was time to start optimizing and making this thing run the way I wanted. The ...">
    
    <link rel="stylesheet" href="/assets/css/style.css">
    <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Matt Blogs IT" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Configure Surface to use MicroSD as Primary Storage | Matt Blogs IT</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Configure Surface to use MicroSD as Primary Storage" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="After about a week of excitement and playing around with features, I decided it was time to start optimizing and making this thing run the way I wanted. The first thing I noticed was that I could not use my SD card with my Libraries, so all my apps are going to by default save to the local SSD, which is far from what I want. I knew there had to be a way around this, so I started digging in. I feel I finally have it to the point where others should be doing the same thing, and once done, you can forget about it." />
<meta property="og:description" content="After about a week of excitement and playing around with features, I decided it was time to start optimizing and making this thing run the way I wanted. The first thing I noticed was that I could not use my SD card with my Libraries, so all my apps are going to by default save to the local SSD, which is far from what I want. I knew there had to be a way around this, so I started digging in. I feel I finally have it to the point where others should be doing the same thing, and once done, you can forget about it." />
<link rel="canonical" href="http://0.0.0.0:4000/configure-surface-to-use-microsd-as-primary-storage/" />
<meta property="og:url" content="http://0.0.0.0:4000/configure-surface-to-use-microsd-as-primary-storage/" />
<meta property="og:site_name" content="Matt Blogs IT" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-11-09T00:00:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Configure Surface to use MicroSD as Primary Storage" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2012-11-09T00:00:00-08:00","datePublished":"2012-11-09T00:00:00-08:00","description":"After about a week of excitement and playing around with features, I decided it was time to start optimizing and making this thing run the way I wanted. The first thing I noticed was that I could not use my SD card with my Libraries, so all my apps are going to by default save to the local SSD, which is far from what I want. I knew there had to be a way around this, so I started digging in. I feel I finally have it to the point where others should be doing the same thing, and once done, you can forget about it.","headline":"Configure Surface to use MicroSD as Primary Storage","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/configure-surface-to-use-microsd-as-primary-storage/"},"url":"http://0.0.0.0:4000/configure-surface-to-use-microsd-as-primary-storage/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
    <header class="site-header">
        <div class="wrapper">
            <a class="site-title" href="/">Matt Blogs IT</a>
            <nav class="site-nav">
                <a href="/">Home</a>
                <a href="/about-me/">About</a>
                <a href="/archive/">Archive</a>
                <a href="/contact-me/">Contact</a>
                <a href="/my-credentials/">Credentials</a>
            </nav>
        </div>
    </header>

    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Configure Surface to use MicroSD as Primary Storage</h1>
        <p class="post-meta">
            <time datetime="2012-11-09T00:00:00-08:00" itemprop="datePublished">
                November 09, 2012
            </time>
            
                | Categories: 
                
                    <span class="category">microsoft</span>
                
            
        </p>
    </header>

    <div class="post-content" itemprop="articleBody">
        <p>After about a week of excitement and playing around with features, I decided it was time to start optimizing and making this thing run the way I wanted. The first thing I noticed was that I could not use my SD card with my Libraries, so all my apps are going to by default save to the local SSD, which is far from what I want. I knew there had to be a way around this, so I started digging in. I feel I finally have it to the point where others should be doing the same thing, and once done, you can forget about it.</p>

<ul>
  <li>Create a VHDX and save it on the SD card</li>
  <li>Create directories on this VHD for your specific libraries
    <ul>
      <li>Documents</li>
      <li>Music</li>
      <li>Video</li>
      <li>Pictures</li>
    </ul>
  </li>
  <li>Configure the libraries</li>
  <li>Enable Indexing on the VHDX - This is important because the Photos app doesn’t work right without it.</li>
  <li>Have a script automatically Attach the VHD on Boot</li>
</ul>

<p>If you would like to know the exact steps to take, please continue reading.</p>

<h1 id="creating-a-vhd">Creating a VHD</h1>

<ol>
  <li>Open Charms Menu (Swipe in from the right side of the screen)</li>
  <li>Click Settings</li>
  <li>Click Tiles</li>
  <li>Change “Show administrative tools” to Yes</li>
  <li>Swipe from the bottom of the screen</li>
  <li>Click All apps</li>
  <li>Under “Administrative Tools” click Computer Management</li>
  <li>Click “Disk Management”</li>
  <li>Click “Action”</li>
  <li>Click “Create VHD”</li>
  <li>Browse to the SD Card’s storage and name the VHD whatever you want</li>
  <li>Allocate as much of the SD’s storage you want to this VHD,</li>
  <li>You can decide between Fixed or Dynamically expanding. I went with Dynamically expanding.</li>
  <li>Find the newly created disk in the lower panel, which should be “Disk 2”</li>
  <li>Right-click where it says “Disk 2”</li>
  <li>Click “Initialize Disk”</li>
  <li>Click OK</li>
  <li>Right-click “Unallocated”</li>
  <li>Click “New Simple Volume…”</li>
  <li>Click “Next &gt;”</li>
  <li>Click “Next &gt;”</li>
  <li>Select the Drive letter you want (can be anything)</li>
  <li>Click “Next &gt;”</li>
  <li>Name the Volume whatever you want</li>
  <li>Click “Next &gt;”</li>
  <li>Click “Finish”</li>
</ol>

<h1 id="createconfigure-library-directories-on-vhd">Create/Configure Library Directories on VHD</h1>

<ol>
  <li>Click the “Libraries” icon from the “Task Bar”</li>
  <li>Single click “Documents”</li>
  <li>Click “Manage under “Library Tools” from the ribbon</li>
  <li>Click “Manage library”</li>
  <li>Click “Add”</li>
  <li>Browse to the newly Attached VHD you just created</li>
  <li>Click “New Folder”</li>
  <li>Name it whatever you want (Eg: Documents)</li>
  <li>DO NOT OPEN THE FOLDER, select the folder and click “Include folder”</li>
  <li>Remove the Default Personal folder</li>
  <li>Click OK</li>
  <li>Click “Set save location”</li>
  <li>Select the newly created folder</li>
  <li>Repeat steps 1-13 for the following
    <ol>
      <li>Music</li>
      <li>Pictures</li>
      <li>Videos</li>
    </ol>
  </li>
</ol>

<h1 id="enable-indexing-on-vhd---very-important">Enable Indexing on VHD - Very Important</h1>

<ol>
  <li>Open the “Charms Menu”</li>
  <li>Click “Search”</li>
  <li>Type “Indexing Options”</li>
  <li>Click Settings</li>
  <li>Open “Indexing Options”</li>
  <li>Click “Modify”</li>
  <li>Select the newly Attached VHD</li>
  <li>Click OK</li>
  <li>Click Close</li>
</ol>

<h1 id="create-script-to-auto-attach-on-startup">Create Script to Auto Attach on Startup</h1>

<ol>
  <li>Open PowerShell as an Administrator</li>
  <li>Type “Set-ExecutionPolicy RemoteSigned”</li>
  <li>Press Enter</li>
  <li>Type “y”</li>
  <li>Press Enter</li>
  <li>Click Computer from the navigation bar on the left of the Libraries folder</li>
  <li>Open the C: Drive</li>
  <li>Create a new folder named “PoSH”</li>
  <li>Double click the new folder</li>
  <li>Right-click in the white area and navigate to “New &gt; Text Document”</li>
  <li>Name it Auto-Mount.ps1</li>
  <li>Open the new file with Notepad</li>
  <li>Paste the below code in, don’t forget to modify the red text to the path you saved the VHDX file at
    <ol>
      <li>“Mount-DiskImage D:\YourVHD.vhdx”</li>
    </ol>
  </li>
  <li>Open the “Charms Menu”</li>
  <li>Click “Search”</li>
  <li>Type “Task Scheduler” and open it</li>
  <li>Click “Task Scheduler Library”</li>
  <li>Click “Action”</li>
  <li>Click “Create Task…”</li>
  <li>General Tab
    <ol>
      <li>Name: Attach SD VHD</li>
      <li>Location: \</li>
      <li>Description: This is the Task that automatically attaches the VHD file on the SD card on system boot.</li>
      <li>“Click Change User or Group…” type in SYSTEM</li>
      <li>Check “Run with highest privileges”</li>
    </ol>
  </li>
  <li>Triggers Tab
    <ol>
      <li>Click “New…”</li>
      <li>Begin the task: At startup</li>
      <li>Click OK</li>
    </ol>
  </li>
  <li>Action Tab
    <ol>
      <li>Action: Start a program</li>
      <li>Program/script: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</li>
      <li>Add arguments: C:\PoSH\Auto-Mount.ps1</li>
      <li>Click “OK”</li>
    </ol>
  </li>
  <li>Conditions Tab
    <ol>
      <li>Under Power uncheck “Start the task only if the computer is on AC power</li>
      <li>Click “OK”</li>
    </ol>
  </li>
  <li>Have fun testing. I recommend opening the Camera app and taking some pictures, making sure it index the new ones, try adding music to the folder make sure it shows up in the music app, the same thing for the Video app.</li>
</ol>

<p><strong>Update 12-30-2012</strong>: Thank you, Don, for reminding me you need to set the execution policy on the machine first.</p>

    </div>

    
    <div class="post-tags">
        <strong>Tags:</strong>
        
            <span class="tag">how-to</span>, 
        
            <span class="tag">microsoft-surface</span>, 
        
            <span class="tag">surface-rt</span>, 
        
            <span class="tag">windows-8</span>
        
    </div>
    
</article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="wrapper">
            <p>&copy; 2025 Matt Blogs IT. All rights reserved.</p>
            <p>
                
                <a href="https://github.com/mattgriffin">GitHub</a> |
                
                
                <a href="https://twitter.com/mattgriffinit">Twitter</a>
                
            </p>
        </div>
    </footer>
</body>
</html>