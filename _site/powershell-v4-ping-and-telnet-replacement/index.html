<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell v4 Ping and Telnet Replacement - Matt Blogs IT</title>
    <meta name="description" content="Note: Article Written on Server 2012 R2 Preview Build, the functionality may change when released.">
    
    <link rel="stylesheet" href="/assets/css/style.css">
    <link type="application/atom+xml" rel="alternate" href="http://0.0.0.0:4000/feed.xml" title="Matt Blogs IT" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>PowerShell v4 Ping and Telnet Replacement | Matt Blogs IT</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="PowerShell v4 Ping and Telnet Replacement" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Note: Article Written on Server 2012 R2 Preview Build, the functionality may change when released." />
<meta property="og:description" content="Note: Article Written on Server 2012 R2 Preview Build, the functionality may change when released." />
<link rel="canonical" href="http://0.0.0.0:4000/powershell-v4-ping-and-telnet-replacement/" />
<meta property="og:url" content="http://0.0.0.0:4000/powershell-v4-ping-and-telnet-replacement/" />
<meta property="og:site_name" content="Matt Blogs IT" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-06-28T00:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PowerShell v4 Ping and Telnet Replacement" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2013-06-28T00:00:00-07:00","datePublished":"2013-06-28T00:00:00-07:00","description":"Note: Article Written on Server 2012 R2 Preview Build, the functionality may change when released.","headline":"PowerShell v4 Ping and Telnet Replacement","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/powershell-v4-ping-and-telnet-replacement/"},"url":"http://0.0.0.0:4000/powershell-v4-ping-and-telnet-replacement/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
    <header class="site-header">
        <div class="wrapper">
            <a class="site-title" href="/">Matt Blogs IT</a>
            <nav class="site-nav">
                <a href="/">Home</a>
                <a href="/about-me/">About</a>
                <a href="/archive/">Archive</a>
                <a href="/contact-me/">Contact</a>
                <a href="/my-credentials/">Credentials</a>
            </nav>
        </div>
    </header>

    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">PowerShell v4 Ping and Telnet Replacement</h1>
        <p class="post-meta">
            <time datetime="2013-06-28T00:00:00-07:00" itemprop="datePublished">
                June 28, 2013
            </time>
            
                | Categories: 
                
                    <span class="category">administrator</span>, 
                
                    <span class="category">microsoft</span>
                
            
        </p>
    </header>

    <div class="post-content" itemprop="articleBody">
        <p><strong>Note: Article Written on Server 2012 R2 Preview Build, the functionality may change when released.</strong></p>

<p><img src="/assets/images/posts/Test-NetConnection.jpg" alt="" /></p>

<p>I have been waiting for years for a good replacement for what Telnet and Ping provide me. I am thrilled to announce today I discovered a legitimate replacement has come down the line! Recently Microsoft released the Preview of Server 2012 R2 and Windows 8.1. Packaged with those is PowerShell Version 4. I have not had a chance to do a deep dive into it yet. However, I have found out that there is a cool new cmdlet called Test-NetConnection.</p>

<!--more-->

<p>The Test-NetConnection command does precisely what it sounds like. By default (No Parameters), the command performs a ping on internetbeacon.msedge.net, which at the time of writing, this is failing. This tool does a lot more than just ping, it also adds traceroute, and connection attempts to specified ports. Below is a snapshot of the Syntex for this cmdlet.</p>

<p><img src="/assets/images/posts/Test-NetConnection_Syntax.jpg" alt="" /></p>

<p>Let’s say we have a server running that allows Remote Desktop Connection. We know it exists. However, for some reason, connections are not working. Once you verified RDP is enabled through the console, the next step might be verifying you can get through the firewall. The way I usually approach this is by using “telnet <em>server.name</em> 3389” well, the problem with this is that the server may not have the telnet client installed, that was an optional install starting in Server 2008.</p>

<p>I was hoping for something in PowerShell v3, but sadly nothing showed up. However, tonight I found out thanks to a Microsoft employee presenting named Bob Roudebush that this now exists! So instead of installing telnet, I can use the PowerShell cmdlet “Test-NetConnection <em>server.name</em> -Port 3389”. Please note that you can also use “Test-NetConnection <em>server.name</em> -CommonTCPPort RDP”</p>

<p><img src="/assets/images/posts/Test-NetConnection_Port.jpg" alt="" /></p>

<p>Let’s not stop at something that simple now, because PowerShell is all about automating. So let’s try to do something crazy. I know on my virtual lab at home, I have a few VM’s running, so let’s verify RDP is open on all of these servers. Luckily for me, most of them are joined to an Active Directory, so let’s do some magic.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(Get-ADComputer -LDAPFilter "(name=griffin*)").DNSHostName | Test-NetConnection -Port 3389
</code></pre></div></div>

<p>The above command pulls every computer from Active Directory (Using the Active Directory PowerShell Tools) and pipe it to Test-NetConnection, which specifies the RDP port.</p>

    </div>

    
    <div class="post-tags">
        <strong>Tags:</strong>
        
            <span class="tag">microsoft</span>, 
        
            <span class="tag">ping</span>, 
        
            <span class="tag">powershell</span>, 
        
            <span class="tag">powershell-v4</span>, 
        
            <span class="tag">server-2012-r2</span>, 
        
            <span class="tag">telnet</span>, 
        
            <span class="tag">windows-8-1</span>
        
    </div>
    
</article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="wrapper">
            <p>&copy; 2025 Matt Blogs IT. All rights reserved.</p>
            <p>
                
                <a href="https://github.com/mattgriffin">GitHub</a> |
                
                
                <a href="https://twitter.com/mattgriffinit">Twitter</a>
                
            </p>
        </div>
    </footer>
</body>
</html>