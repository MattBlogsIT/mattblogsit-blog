# Sveltia CMS Configuration for Matt Blogs IT
# Documentation: https://github.com/sveltia/sveltia-cms

# ============================================================================
# AUTHENTICATION SETUP - Choose one of two methods:
# ============================================================================
#
# METHOD 1: OAuth with Cloudflare Workers (RECOMMENDED)
# - Better user experience (click "Login with GitHub")
# - More secure (automatic token rotation)
# - Better for multiple editors
# - Setup: See SVELTIA_CMS_SETUP.md for Cloudflare Worker deployment
#
# METHOD 2: Personal Access Token (PAT) (ALTERNATIVE)
# - Simpler setup (no OAuth configuration)
# - Good for solo developers
# - Setup: Create GitHub PAT with 'repo' scope, paste when logging in
# - To use PAT: Comment out the auth_endpoint line below
# ============================================================================

backend:
  name: github
  repo: MattBlogsIT/mattblogsit-blog
  branch: main
  # OAuth endpoint (METHOD 1) - Replace with your Cloudflare Worker URL
  # After deploying Cloudflare Worker, uncomment and update this line:
  base_url: https://sveltia-cms-auth.mattgrif90.workers.dev
  #
  # For PAT authentication (METHOD 2): Keep base_url commented out

# Media files configuration
media_folder: "assets/img"
public_folder: "/assets/img"

# Editorial workflow (optional) - Enable for draft/published states
# publish_mode: editorial_workflow

# Site URL for previews
site_url: https://mattblogsit.com

# Logo for CMS interface
logo_url: https://mattblogsit.com/assets/img/logo.png

# ============================================================================
# COLLECTIONS - Define content types
# ============================================================================

collections:
  # Blog Posts Collection
  - name: "posts"
    label: "Blog Posts"
    label_singular: "Blog Post"
    folder: "_posts"
    create: true
    slug: "{{year}}-{{month}}-{{day}}-{{slug}}"
    preview_path: "{{categories}}/{{slug}}/"
    editor:
      preview: true

    # Post fields matching your Jekyll frontmatter
    fields:
      - label: "Title"
        name: "title"
        widget: "string"
        hint: "Post title (required for SEO and display)"

      - label: "Publication Date"
        name: "date"
        widget: "datetime"
        format: "YYYY-MM-DD"
        date_format: "YYYY-MM-DD"
        time_format: false
        hint: "Publication date (YYYY-MM-DD format required)"

      - label: "Categories"
        name: "categories"
        widget: "select"
        multiple: true
        min: 1
        max: 3
        hint: "Select 1-3 categories (REQUIRED - must use approved categories)"
        options:
          - { label: "Administrator", value: "Administrator" }
          - { label: "Microsoft", value: "Microsoft" }
          - { label: "VMware", value: "VMware" }
          - { label: "Out of Band", value: "Out of Band" }
          - { label: "Getting Started", value: "Getting Started" }
          - { label: "User", value: "User" }
          - { label: "Developer", value: "Developer" }
          - { label: "Infrastructure", value: "Infrastructure" }
          - { label: "Athletics", value: "Athletics" }
          - { label: "Review", value: "Review" }

      - label: "Excerpt"
        name: "excerpt"
        widget: "text"
        hint: "Brief description for SEO and post previews (160 characters recommended)"
        pattern: ['^.{50,200}$', "Excerpt should be 50-200 characters for optimal SEO"]

      - label: "Tags"
        name: "tags"
        widget: "list"
        required: false
        hint: "Optional tags for additional categorization (lowercase with hyphens)"
        field:
          label: "Tag"
          name: "tag"
          widget: "string"
          pattern: ['^[a-z0-9-]+$', "Tags must be lowercase with hyphens (e.g., microsoft-365)"]

      - label: "Featured Image"
        name: "featured_image"
        widget: "image"
        required: false
        hint: "Optional featured image (max 500 KB, will be optimized by CI/CD)"

      - label: "Featured Image Alt Text"
        name: "featured_image_alt"
        widget: "string"
        required: false
        hint: "Required if featured image is set (accessibility and SEO)"

      - label: "Body"
        name: "body"
        widget: "markdown"
        hint: "Post content in Markdown format"
        buttons:
          - bold
          - italic
          - code
          - link
          - heading-two
          - heading-three
          - heading-four
          - quote
          - bulleted-list
          - numbered-list
        editor_components:
          - image
          - code-block

  # Static Pages Collection
  - name: "pages"
    label: "Pages"
    label_singular: "Page"
    folder: "_pages"
    create: true
    slug: "{{slug}}"
    preview_path: "{{slug}}/"

    fields:
      - label: "Title"
        name: "title"
        widget: "string"

      - label: "Permalink"
        name: "permalink"
        widget: "string"
        hint: "URL path (e.g., /about/)"
        pattern: ['^/.*/$', "Permalink must start and end with /"]

      - label: "Body"
        name: "body"
        widget: "markdown"

# ============================================================================
# ADVANCED CONFIGURATION
# ============================================================================

# Show file path in editor
slug:
  encoding: "ascii"
  clean_accents: true

# Local backend for development (optional)
# Uncomment to test CMS locally without GitHub authentication:
# local_backend: true
